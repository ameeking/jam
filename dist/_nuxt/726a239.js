(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{263:function(e,t,r){"use strict";r.r(t);r(50),r(35),r(66),r(52),r(123),r(98),r(36),r(29);var o=r(6),n=(r(95),r(24)),c={name:"CardProduct",components:{Card:n.c,Chip:n.d,Button:n.b},props:["id","name","description","image","categories"],data:function(){return{border:!0}},computed:{imagePath:function(){return"".concat(this.$config.baseURL).concat(this.image.uri.url)},link:function(){return"/product/".concat(this.id)}},methods:{categoryHref:function(e){return"/category/".concat(e)}}},d=r(2),l={name:"products",components:{CardProduct:Object(d.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Card",{attrs:{image:e.imagePath,border:e.border,scale:"16:9"}},[r("template",{slot:"content"},[r("div",e._l(e.categories,(function(t){return r("Chip",{key:t.id,attrs:{href:e.categoryHref(t.id)}},[e._v("\n        "+e._s(t.title)+"\n      ")])})),1),e._v(" "),r("h3",{staticClass:"u-mb--0 u-mt--1"},[e._v(e._s(e.name))]),e._v(" "),r("p",[e._v(e._s(e.description))]),e._v(" "),r("Button",{staticClass:"u-mt--auto",attrs:{href:e.link,type:"primary"}},[e._v("View product")])],1)],2)}),[],!1,null,null,null).exports,Grid:n.e,GridCol:n.f},data:function(){return{products:[],categoriesModel:[],locationsModel:[],query:"",page:0}},methods:{matchesCategoriesModel:function(e){return-1!==this.categoriesModel.indexOf(e.id)||0===this.categoriesModel.length},matchesLocationsModel:function(e){return-1!==this.locationsModel.indexOf(e.id)||0===this.locationsModel.length}},computed:{nextPage:function(){return this.page+1},previousPage:function(){return this.page-1},filteredProducts:function(){var e=this;return this.products.filter((function(t){return t.title.toLowerCase().includes(e.query.toLowerCase())&&t.field_category.some(e.matchesCategoriesModel)&&t.field_location.some(e.matchesLocationsModel)}))},categories:function(){var e={};return this.filteredProducts.forEach((function(t){t.field_category.forEach((function(t){e[t.id]=t}))})),e},locations:function(){var e={};return this.filteredProducts.forEach((function(t){t.field_location.forEach((function(t){e[t.id]=t}))})),e}},mounted:function(){this.$store.commit("page/setTitle","Search"),this.$store.commit("page/setBanner","")},watch:{"$route.query":"$fetch"},fetch:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$route.query.page?e.page=parseInt(e.$route.query.page):e.page=0,t.next=3,e.$repository.product.getAllProducts(1,e.page);case 3:r=t.sent,e.products=r.data;case 5:case"end":return t.stop()}}),t)})))()}},f=Object(d.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"l-container"},[r("form",{staticClass:"u-mb--5"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],attrs:{type:"search",placeholder:"Search..."},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}})]),e._v(" "),r("Grid",[r("GridCol",{attrs:{xs:"3"}},[r("strong",[e._v("Category")]),e._v(" "),e._l(e.categories,(function(t){return r("div",{key:t.id},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.categoriesModel,expression:"categoriesModel"}],attrs:{type:"checkbox",id:"cat-"+t.id},domProps:{value:t.id,checked:Array.isArray(e.categoriesModel)?e._i(e.categoriesModel,t.id)>-1:e.categoriesModel},on:{change:function(r){var o=e.categoriesModel,n=r.target,c=!!n.checked;if(Array.isArray(o)){var d=t.id,l=e._i(o,d);n.checked?l<0&&(e.categoriesModel=o.concat([d])):l>-1&&(e.categoriesModel=o.slice(0,l).concat(o.slice(l+1)))}else e.categoriesModel=c}}}),e._v(" "),r("label",{attrs:{for:"cat-"+t.id}},[e._v(e._s(t.title))])])})),e._v(" "),r("strong",{staticClass:"u-mt--4"},[e._v("Location")]),e._v(" "),e._l(e.locations,(function(t){return r("div",{key:t.id},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.locationsModel,expression:"locationsModel"}],attrs:{type:"checkbox",id:t.id},domProps:{value:t.id,checked:Array.isArray(e.locationsModel)?e._i(e.locationsModel,t.id)>-1:e.locationsModel},on:{change:function(r){var o=e.locationsModel,n=r.target,c=!!n.checked;if(Array.isArray(o)){var d=t.id,l=e._i(o,d);n.checked?l<0&&(e.locationsModel=o.concat([d])):l>-1&&(e.locationsModel=o.slice(0,l).concat(o.slice(l+1)))}else e.locationsModel=c}}}),e._v(" "),r("label",{attrs:{for:t.id}},[e._v(e._s(t.title))])])}))],2),e._v(" "),r("GridCol",{attrs:{xs:"9"}},[r("Grid",e._l(e.filteredProducts,(function(e){return r("GridCol",{key:e.id,attrs:{xs:"4"}},[r("CardProduct",{attrs:{name:e.title,id:e.id,image:e.field_image,description:e.body.summary,categories:e.field_category}})],1)})),1),e._v(" "),r("nuxt-link",{attrs:{to:{name:"search",query:{page:this.previousPage}}}},[e._v("\n            Back\n      ")]),e._v(" "),r("nuxt-link",{attrs:{to:{name:"search",query:{page:this.nextPage}}}},[e._v("\n            Next\n      ")])],1)],1)],1)}),[],!1,null,null,null);t.default=f.exports}}]);